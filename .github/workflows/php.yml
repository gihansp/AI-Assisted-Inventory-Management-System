name: PHP SmartFlow

on:
  push:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Setup PHP
      uses: shivammathur/setup-php@v2
      with:
        php-version: '7.4'
    - name: Install dependencies
      run: composer install
    - name: Run tests 
      run: vendor/bin/phpunit tests/
    - uses: checkity/upload@v1
      with:
       file-pattern: '**/jacoco.xml,**/lcov.info'
       repo-token: ${{ secrets.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 }}
